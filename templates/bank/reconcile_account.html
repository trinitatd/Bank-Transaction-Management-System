{% extends 'bank/base.html' %}
{% block title %}Reconcile Account - BTMS{% endblock %}

{% block content %}
<style>
  /* Background (reuse your bank interior or subtle gradient) */
  body {
    background: linear-gradient(135deg, #e0f7fa, #f1faff);
    background-attachment: fixed;
    min-height: 100vh;
  }

  .reconcile-card {
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    border-radius: 18px;
    padding: 40px 35px;
    max-width: 600px;
    margin: 90px auto 50px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.15);
    animation: fadeIn 1s ease;
  }

  @keyframes fadeIn {
    from {opacity: 0; transform: translateY(-10px);}
    to {opacity: 1; transform: translateY(0);}
  }

  .reconcile-card h2 {
    text-align: center;
    margin-bottom: 25px;
    color: #004e89;
    font-weight: 600;
  }

  .reconcile-card form {
    display: flex;
    flex-direction: column;
    gap: 18px;
  }

  .form-check {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .form-check-input {
    width: 18px;
    height: 18px;
    accent-color: #0077b6;
  }

  .btn-primary {
    background: linear-gradient(90deg, #0077b6, #00b4d8);
    border: none;
    border-radius: 10px;
    padding: 12px;
    font-weight: 600;
    color: white;
    transition: all 0.3s ease;
  }

  .btn-primary:hover {
    background: linear-gradient(90deg, #00b4d8, #0077b6);
    transform: translateY(-2px);
  }

  .btn-secondary {
    background: #f1f1f1;
    border-radius: 10px;
    padding: 12px;
    color: #333;
    font-weight: 600;
    transition: all 0.3s ease;
  }

  .btn-secondary:hover {
    background: #e6e6e6;
    transform: translateY(-2px);
  }

  .reconcile-result {
    background: rgba(0, 183, 195, 0.08);
    border-left: 4px solid #00b4d8;
    padding: 15px 20px;
    border-radius: 10px;
    margin-top: 25px;
  }

  .reconcile-result h4 {
    color: #0077b6;
    margin-bottom: 10px;
  }
</style>

<div class="reconcile-card">
  <h2>Reconcile Account {{ account_no }}</h2>

  <form method="post">
    {% csrf_token %}
    <div class="form-check mb-3">
      <input class="form-check-input" type="checkbox" value="1" id="fix" name="fix">
      <label class="form-check-label" for="fix">Automatically fix discrepancies (update DB)</label>
    </div>
    <div class="d-flex justify-content-between gap-3">
      <button class="btn btn-primary w-100" type="submit">Run Reconciliation</button>
      <a class="btn btn-secondary w-100" href="{% url 'dashboard' %}">Cancel</a>
    </div>
  </form>

  {% if result and result.audit %}
  <div class="reconcile-result">
    <h4>Last Reconciliation Summary</h4>
    <p><strong>Previous Balance:</strong> ₹{{ result.audit.0 }}</p>
    <p><strong>New Balance:</strong> ₹{{ result.audit.1 }}</p>
    <p><strong>Reconciled At:</strong> {{ result.audit.2 }}</p>
  </div>
  {% endif %}
</div>
{% endblock %}
